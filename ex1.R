## ----setup, include=FALSE------------------------------------------------
knitr::opts_chunk$set(echo = TRUE)


## ------------------------------------------------------------------------
x <- c()
x[20:30] <- c(20:30)
x


## ------------------------------------------------------------------------
x
qx_d_ind <- c()
qx_d_ind[20:30]<-0.001+0.0001*x[20:30]
qx_d_ind


## ------------------------------------------------------------------------
qx_w_ind <- c()
qx_w_ind[20:30] <- pmax(0.1,0.2-0.02*(x[20:30]-20))
qx_w_ind


## ------------------------------------------------------------------------
qx.d.dep <- c()
qx.d.dep[20:30] <- qx_d_ind[20:30]*(1-0.5*qx_w_ind[20:30])
qx.d.dep


## ------------------------------------------------------------------------
qx.w.dep <- c()
qx.w.dep[20:30] <- qx_w_ind[20:30]*(1-0.5*qx_d_ind[20:30])
qx.w.dep


## ------------------------------------------------------------------------
al.x <- c()
al.x[20] <- 100000


## ------------------------------------------------------------------------
ad.x.d <- c()
ad.x.w <- c()

al.x[21:30] <- al.x[20:29]*(1-qx.w.dep[20:29]-qx.d.dep[20:29])
al.x


## ------------------------------------------------------------------------
for (j in 20:30) {
  ad.x.d[j] <- al.x[j]*qx.d.dep[j]
  ad.x.w[j] <- al.x[j]*qx.w.dep[j]
  al.x[j+1] <- al.x[j]-ad.x.d[j]-ad.x.w[j]
}
al.x
al.x[20:30]


## ------------------------------------------------------------------------
pretty <- cbind(x[20:30],qx_d_ind[20:30])
colnames(pretty) <- c("x",
                    "qx_d_ind")
pretty
colnames(pretty) <- c("x[20:30]",
                   "qx_d_ind[20:30]")
pretty


## ------------------------------------------------------------------------
prems.BoY <- c(rep(1300,10))
prems.BoY


## ------------------------------------------------------------------------
Exp.BoY <- c()
Exp.BoY[1] <- 115
t.base <- c(rep(1,10))
t.series <- cumsum(t.base)
t.series


## ------------------------------------------------------------------------
foo <- 1:10
foo
foo <- (1:10)
foo
foo <- c(1:10)
foo
1:10


## ------------------------------------------------------------------------
Exp.BoY[2:10] <- 15*1.07^t.series[1:9]
Exp.BoY


## ------------------------------------------------------------------------
Death.EoY <- c(rep(20000,10))
Death.EoY


## ------------------------------------------------------------------------
Wdrwl.EoY <- t.series*prems.BoY
Wdrwl.EoY


## ------------------------------------------------------------------------
Mat.EoY <- c(rep(0,9),20000)
Mat.EoY


## ------------------------------------------------------------------------
Eprem.BoY <- prems.BoY*al.x[20:29]/al.x[20]
Eprem.BoY


## ------------------------------------------------------------------------
Eexp.BoY <- Exp.BoY*al.x[20:29]/al.x[20]
Eexp.BoY


## ------------------------------------------------------------------------
Edeath.EoY <- Death.EoY*ad.x.d[20:29]/al.x[20]
Edeath.EoY


## ------------------------------------------------------------------------
Ewdrwl.EoY <- Wdrwl.EoY*ad.x.w[20:29]/al.x[20]
Ewdrwl.EoY


## ------------------------------------------------------------------------
Emat.EoY <- Mat.EoY*al.x[21:30]/al.x[20]
Emat.EoY


## ------------------------------------------------------------------------
int <- .08
ECF.EoY <- (Eprem.BoY-Eexp.BoY)*(1+int)-Edeath.EoY-Ewdrwl.EoY-Emat.EoY
ECF.EoY


## ------------------------------------------------------------------------
disc.vec <- 1/(1+int)^(1:10)
disc.vec

PV.at.ER <- disc.vec*ECF.EoY
PV.at.ER
sum(PV.at.ER)

uniroot()